# 大文件读写

|        |                                |
| ------ | ------------------------------ |
| log    | 写性能好(append), 随机读性能差 |
| B tree | 读性能好 写性能差              |
| LSM    | 都还可以                       |

LSM的思想，在于对数据的修改增量保持在内存中，达到指定的限制后将这些修改操作批量写入到磁盘中，相比较于写入操作的高性能，读取需要合并内存中最近修改的操作和磁盘中历史的数据，即需要先看是否在内存中，若没有命中，还要访问磁盘文件。

原理：把一颗大树拆分成N棵小树，数据先写入内存中，随着小树越来越大，内存的小树会flush到磁盘中。磁盘中的树定期做合并操作，合并成一棵大树，以优化读性能。

对应于使用LSM的Leveldb来说，对于一个写操作，先写入到memtable中，当memtable达到一定的限制后，这部分转成immutable memtable（不可写），当immutable memtable达到一定限制，将flush到磁盘中，即sstable.，sstable再进行compaction操作。



作者：mina
链接：https://www.zhihu.com/question/19887265/answer/365078623
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
